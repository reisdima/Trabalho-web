<!DOCTYPE html>
<html lang="pt" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title>Trabalho 03</title>
    <style>
      body{
        font-family: arial;
      }
      input{
        width: 150px;
      }
      .delete{
        visibility:hidden;
        position: relative;
        left: 108px;

      }
      .label1{

      }
      .label2{
        position: relative;
        top: 4px;
      }
      .lista1{
        position: absolute;
        left: 30px;
        top: 80px;
      }
      .lista2{
        position: absolute;
        left: 200px;
        top: 80px;
      }
      button{
        position: relative;
        top: 8px;
      }
      .input1{
        position: absolute;
        left: 80px;
      }
      .input2{
        position: relative;
        left: 28px;
      }
      .listaAdulto{
        position: relative;
        bottom: 10px;
      }
    </style>
  </head>
  <body>
    <form class="formulario" name="dados">
      <div class="label1"><label>Nome:<input type="text" name="nome" placeholder='Digite seu nome' class="input1"> </label></div>
      <div class="label2"><label>Idade:<input type="number" name="idade" placeholder="Digite sua idade" class="input2"> </label></div>
      <div>
        <button type="button">Enviar</button>
        <button type="button" class="delete">Deletar</button>
      </div>
      <div class="lista1">
        <h4>Adultos</h4>
        <ul class="listaAdulto"><li>Teste</li></ul>
      </div>
      <div class="lista2">
        <h4>Crian√ßas</h4>
        <ul><li>Teste</li></ul>
      </div>
    </form>
  </body>
  <script>
    var nome = document.dados.nome;
    var idade = document.dados.idade;
    var nomeAdulto = [];
    var idadeAdulto = [];
    var nomeEstudante = [];
    var idadeEstudante = [];
    var verifica = -1;
    var atual = -1;
    var listas = document.querySelectorAll('ul');
    var botao = document.querySelectorAll('button');
    botaoEnviar = botao[0];
    botaoDeletar = botao[1];

    botaoEnviar.addEventListener('click', enviaFormulario);
    botaoDeletar.addEventListener('click', deletar);
    function deletar(){
      if(atual>=18){
        nomeAdulto.splice(verifica, 1);
        nome.value = '';
        idade.value = '';
        nome.focus();
        exibeAdulto();
      }
      else{
        nomeEstudante.splice(verifica, 1);
        nome.value = '';
        idade.value = '';
        nome.focus();
        exibeEstudante();
      }
      verifica = -1;
      botaoEnviar.textContent = 'Enviar';
      botaoDeletar.style = 'visibility: hidden';
    }

    function exibeAdulto(){
      var lista = listas[0];
      lista.innerHTML = '';
      for (var i = 0; i < nomeAdulto.length; i++) {
        var novoLi = document.createElement('li');
        novoLi.textContent = nomeAdulto[i];
        novoLi.style.cursor = 'pointer';
        lista.appendChild(novoLi);
        novoLi.addEventListener('click',(function(x){
          return function(e){
            nome.value = nomeAdulto[x];
            idade.value = idadeAdulto[x];
            nome.focus();
            verifica = x;
            atual = idade.value;
            botaoDeletar.style = 'visibility: visible';
            botaoEnviar.textContent = 'Salvar';
          }
        })(i));
      }
    }
    function exibeEstudante(){
      var lista = listas[1];
      lista.innerHTML = '';
      for (var i = 0; i < nomeEstudante.length; i++) {
        var novoLi = document.createElement('li');
        novoLi.textContent = nomeEstudante[i];
        novoLi.style.cursor = 'pointer';
        lista.appendChild(novoLi);
        novoLi.addEventListener('click', (function(x){
          return function(e){
            nome.value = nomeEstudante[x];
            idade.value = idadeEstudante[x];
            atual = idade.value;
            verifica = x;
            botaoDeletar.style = 'visibility: visible';
            botaoEnviar.textContent = 'Salvar';
          }
        })(i));
      }
    }
    function adiciona(){
      if(idade.value>=18){
        nomeAdulto.push(nome.value);
        idadeAdulto.push(idade.value);
        nome.value = '';
        idade.value = '';
        nome.focus();
        exibeAdulto();
      }
      else{
        nomeEstudante.push(nome.value);
        idadeEstudante.push(idade.value);
        nome.value = '';
        idade.value = '';
        nome.focus();
        exibeEstudante();
      }
    }
    function enviaFormulario(){
      if(verifica===-1){
        adiciona();
      }
      else{
        salva();
      }
    }
    function salva(){
      if(idade.value>=18){
        if(atual>=18){
          nomeAdulto[verifica] = nome.value;
          idadeAdulto[verifica] = idade.value;
          verifica = -1;
          nome.value = '';
          idade.value = '';
          nome.focus();
          exibeAdulto();
        }
        else{
          nomeEstudante.splice(verifica, 1);
          exibeEstudante();
          adiciona();
          verifica = -1;
          nome.value = '';
          idade.value = '';
          nome.focus();
        }
      }
      else{
        if(atual<18){
          nomeEstudante[verifica] = nome.value;
          idadeEstudante[verifica] = idade.value;
          verifica = -1;
          nome.value = '';
          idade.value = '';
          nome.focus();
          exibeEstudante();
        }
        else{
          nomeAdulto.splice(verifica, 1);
          exibeAdulto();
          adiciona();
          nome.value = '';
          idade.value = '';
          nome.focus();
          verifica=-1;
        }
      }
      botaoEnviar.textContent = 'Enviar';
      botaoDeletar.style = 'visibility: hidden';
    }
  </script>
</html>
